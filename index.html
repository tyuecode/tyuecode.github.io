<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>公共协作画板 | 多人在线绘画</title>
  <!-- Tailwind CSS v3 -->
  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Font Awesome -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#4F46E5',
            secondary: '#10B981',
            accent: '#F59E0B',
            dark: '#1F2937',
            light: '#F3F4F6'
          },
          fontFamily: {
            sans: ['Inter', 'system-ui', 'sans-serif'],
          },
          animation: {
            'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
          }
        }
      }
    }
  </script>
  
  <style type="text/tailwindcss">
    @layer utilities {
      .canvas-container {
        touch-action: none;
      }
      .tool-btn {
        @apply flex items-center justify-center w-10 h-10 rounded-full bg-white shadow-md hover:bg-gray-100 transition-all duration-200;
      }
      .tool-btn.active {
        @apply bg-primary text-white;
      }
      .color-btn {
        @apply w-8 h-8 rounded-full border-2 border-white shadow-sm cursor-pointer transition-transform hover:scale-110;
      }
      .slider-thumb {
        @apply appearance-none w-4 h-4 rounded-full bg-primary cursor-pointer;
      }
      .slider-track {
        @apply appearance-none h-2 rounded-full bg-gray-200;
      }
      .tooltip {
        @apply invisible absolute bg-dark text-white text-xs rounded py-1 px-2 -mt-8 opacity-0 transition-opacity duration-300;
      }
      .has-tooltip:hover .tooltip {
        @apply visible opacity-100;
      }
    }
  </style>
</head>
<body class="bg-gray-50 overflow-hidden h-screen flex flex-col">
  <!-- 顶部导航栏 -->
  <header class="bg-white shadow-sm border-b border-gray-200">
    <div class="container mx-auto px-4 py-3 flex items-center justify-between">
      <div class="flex items-center space-x-2">
        <img src="https://p9-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/rc/pc/super_tool/c5695dfec927400893a988ea967f500e~tplv-a9rns2rl98-image.image?rcl=20251223231115DB27B4904A14525B794B&rk3s=8e244e95&rrcfp=f06b921b&x-expires=1769094704&x-signature=m3qYW1RySRFo7Pq5vQZRDfh4cKo%3D" 
             alt="Logo" class="h-8 w-8 object-cover rounded-md">
        <h1 class="text-xl font-bold text-gray-800">公共协作画板</h1>
      </div>
      <div class="flex items-center space-x-4">
        <div id="online-users" class="text-sm text-gray-600">
          <i class="fa fa-user mr-1"></i>
          <span id="user-count">1</span> 人在线
        </div>
        <button id="help-btn" class="text-gray-600 hover:text-primary transition-colors">
          <i class="fa fa-question-circle text-lg"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- 主要内容区 -->
  <main class="flex-1 flex flex-col relative">
    <!-- 工具栏 -->
    <div class="bg-white shadow-sm p-2 flex items-center justify-between z-10">
      <div class="flex items-center space-x-2 px-2">
        <button id="brush-tool" class="tool-btn active" data-tool="brush">
          <i class="fa fa-paint-brush"></i>
          <span class="tooltip">画笔</span>
        </button>
        <button id="eraser-tool" class="tool-btn" data-tool="eraser">
          <i class="fa fa-eraser"></i>
          <span class="tooltip">橡皮擦</span>
        </button>
        <button id="clear-tool" class="tool-btn" data-tool="clear">
          <i class="fa fa-trash"></i>
          <span class="tooltip">清空画布</span>
        </button>
        <div class="h-6 border-r border-gray-300 mx-1"></div>
        <div class="flex items-center space-x-2">
          <label for="brush-size" class="text-sm text-gray-600">粗细:</label>
          <input type="range" id="brush-size" min="1" max="50" value="5" 
                 class="slider-track w-24">
          <span id="size-value" class="text-sm text-gray-600 w-6 text-center">5</span>
        </div>
      </div>
      
      <div class="flex items-center space-x-2">
        <div class="flex items-center space-x-1">
          <span class="text-sm text-gray-600 mr-1">颜色:</span>
          <div class="flex flex-wrap gap-1 w-48">
            <div class="color-btn bg-black" data-color="#000000"></div>
            <div class="color-btn bg-red-500" data-color="#EF4444"></div>
            <div class="color-btn bg-orange-500" data-color="#F97316"></div>
            <div class="color-btn bg-yellow-500" data-color="#EAB308"></div>
            <div class="color-btn bg-green-500" data-color="#22C55E"></div>
            <div class="color-btn bg-blue-500" data-color="#3B82F6"></div>
            <div class="color-btn bg-indigo-500" data-color="#6366F1"></div>
            <div class="color-btn bg-purple-500" data-color="#A855F7"></div>
            <div class="color-btn bg-pink-500" data-color="#EC4899"></div>
            <div class="color-btn bg-white border-gray-300" data-color="#FFFFFF"></div>
          </div>
        </div>
        <input type="color" id="custom-color" value="#000000" 
               class="w-8 h-8 rounded cursor-pointer">
      </div>
      
      <div class="flex items-center space-x-2">
        <button id="replay-btn" class="tool-btn" data-tool="replay">
          <i class="fa fa-play"></i>
          <span class="tooltip">回放绘画过程</span>
        </button>
        <button id="save-btn" class="tool-btn" data-tool="save">
          <i class="fa fa-download"></i>
          <span class="tooltip">保存作品</span>
        </button>
      </div>
    </div>
    
    <!-- 画布区域 -->
    <div class="flex-1 relative overflow-hidden bg-gray-100">
      <canvas id="drawing-canvas" class="absolute top-0 left-0 w-full h-full"></canvas>
      
      <!-- 绘画指示器 -->
      <div id="drawing-indicators" class="absolute top-0 left-0 w-full h-full pointer-events-none"></div>
      
      <!-- 欢迎提示 -->
      <div id="welcome-message" class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 text-center bg-white bg-opacity-90 p-6 rounded-lg shadow-lg max-w-md">
        <h2 class="text-2xl font-bold text-gray-800 mb-2">欢迎来到公共协作画板</h2>
        <p class="text-gray-600 mb-4">这是一个开放的在线画板，所有人都可以在这里创作和查看他人的作品。</p>
        <div class="flex flex-wrap gap-2 justify-center mb-4">
          <span class="px-3 py-1 bg-primary text-white rounded-full text-sm">
            <i class="fa fa-mouse-pointer mr-1"></i> 点击并拖动来绘画
          </span>
          <span class="px-3 py-1 bg-secondary text-white rounded-full text-sm">
            <i class="fa fa-history mr-1"></i> 作品自动保存
          </span>
          <span class="px-3 py-1 bg-accent text-white rounded-full text-sm">
            <i class="fa fa-clock-o mr-1"></i> 查看创作历史
          </span>
        </div>
        <button id="start-drawing" class="bg-primary hover:bg-primary/90 text-white font-medium py-2 px-6 rounded-lg transition-colors">
          开始创作
        </button>
      </div>
      
      <!-- 回放控制 -->
      <div id="replay-controls" class="hidden absolute bottom-4 left-1/2 transform -translate-x-1/2 bg-white bg-opacity-90 p-3 rounded-lg shadow-lg flex items-center space-x-3">
        <button id="replay-play" class="tool-btn">
          <i class="fa fa-play"></i>
        </button>
        <button id="replay-pause" class="tool-btn hidden">
          <i class="fa fa-pause"></i>
        </button>
        <button id="replay-stop" class="tool-btn">
          <i class="fa fa-stop"></i>
        </button>
        <div class="flex items-center space-x-2">
          <label for="replay-speed" class="text-sm text-gray-600">速度:</label>
          <input type="range" id="replay-speed" min="0.5" max="3" step="0.5" value="1" 
                 class="slider-track w-24">
          <span id="speed-value" class="text-sm text-gray-600 w-6 text-center">1x</span>
        </div>
        <div class="text-sm text-gray-600">
          <span id="replay-time">00:00</span> / <span id="total-time">00:00</span>
        </div>
      </div>
    </div>
  </main>

  <!-- 底部状态栏 -->
  <footer class="bg-white border-t border-gray-200 py-2 px-4 text-sm text-gray-600">
    <div class="container mx-auto flex justify-between items-center">
      <div id="status-message">准备就绪，开始创作吧！</div>
      <div id="last-updated">最后更新: 刚刚</div>
    </div>
  </footer>

  <!-- 帮助模态框 -->
  <div id="help-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[80vh] overflow-y-auto">
      <div class="p-6">
        <div class="flex justify-between items-center mb-4">
          <h2 class="text-xl font-bold text-gray-800">使用帮助</h2>
          <button id="close-help" class="text-gray-500 hover:text-gray-700">
            <i class="fa fa-times text-xl"></i>
          </button>
        </div>
        <div class="space-y-4">
          <div>
            <h3 class="font-medium text-lg text-gray-800 mb-2">基本操作</h3>
            <ul class="list-disc pl-5 space-y-1 text-gray-600">
              <li>选择画笔工具，点击并拖动鼠标来绘画</li>
              <li>使用橡皮擦工具可以擦除内容</li>
              <li>调整滑块可以改变画笔粗细</li>
              <li>点击颜色按钮或使用颜色选择器来更改颜色</li>
            </ul>
          </div>
          <div>
            <h3 class="font-medium text-lg text-gray-800 mb-2">高级功能</h3>
            <ul class="list-disc pl-5 space-y-1 text-gray-600">
              <li>点击"回放"按钮可以查看画板的创作历史</li>
              <li>使用"保存"按钮可以将当前作品下载为图片</li>
              <li>所有绘画内容会自动保存，新用户访问时能看到完整的历史创作</li>
            </ul>
          </div>
          <div>
            <h3 class="font-medium text-lg text-gray-800 mb-2">作品持久化</h3>
            <p class="text-gray-600">
              这是一个公共画板，你的所有创作都会自动保存。每次访问网站时，你可以看到之前的所有作品，
              并可以继续创作或查看创作历史。
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // 全局变量
    const canvas = document.getElementById('drawing-canvas');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let lastX = 0;
    let lastY = 0;
    let currentTool = 'brush';
    let currentColor = '#000000';
    let currentSize = 5;
    let drawingHistory = [];
    let isReplaying = false;
    let replayIndex = 0;
    let replayInterval;
    let replaySpeed = 1;
    let userCount = 1;
    
    // 初始化画布
    function initCanvas() {
      // 设置画布尺寸为窗口大小
      function resizeCanvas() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight - 140; // 减去顶部和底部栏的高度
        
        // 重绘画布内容
        redrawCanvas();
      }
      
      window.addEventListener('resize', resizeCanvas);
      resizeCanvas();
      
      // 设置默认样式
      ctx.lineJoin = 'round';
      ctx.lineCap = 'round';
      ctx.lineWidth = currentSize;
      ctx.strokeStyle = currentColor;
      
      // 加载保存的绘画历史
      loadDrawingHistory();
    }
    
    // 开始绘画
    function startDrawing(e) {
      if (isReplaying) return;
      
      isDrawing = true;
      [lastX, lastY] = getCoordinates(e);
      
      // 记录开始绘画的动作
      const timestamp = Date.now();
      const action = {
        type: 'start',
        tool: currentTool,
        color: currentColor,
        size: currentSize,
        x: lastX,
        y: lastY,
        timestamp
      };
      
      drawingHistory.push(action);
      saveDrawingHistory();
    }
    
    // 绘画中
    function draw(e) {
      if (!isDrawing || isReplaying) return;
      
      const [x, y] = getCoordinates(e);
      
      // 绘制线条
      if (currentTool === 'brush') {
        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.stroke();
      } else if (currentTool === 'eraser') {
        ctx.globalCompositeOperation = 'destination-out';
        ctx.beginPath();
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(x, y);
        ctx.stroke();
        ctx.globalCompositeOperation = 'source-over';
      }
      
      // 记录绘画动作
      const timestamp = Date.now();
      const action = {
        type: 'draw',
        tool: currentTool,
        color: currentColor,
        size: currentSize,
        x,
        y,
        lastX,
        lastY,
        timestamp
      };
      
      drawingHistory.push(action);
      saveDrawingHistory();
      
      lastX = x;
      lastY = y;
      
      // 更新状态消息
      document.getElementById('status-message').textContent = '正在绘画...';
      document.getElementById('last-updated').textContent = '最后更新: 刚刚';
    }
    
    // 停止绘画
    function stopDrawing() {
      if (!isDrawing) return;
      
      isDrawing = false;
      
      // 记录停止绘画的动作
      const timestamp = Date.now();
      const action = {
        type: 'stop',
        timestamp
      };
      
      drawingHistory.push(action);
      saveDrawingHistory();
      
      // 更新状态消息
      document.getElementById('status-message').textContent = '准备就绪';
    }
    
    // 获取鼠标或触摸的坐标
    function getCoordinates(e) {
      let x, y;
      
      if (e.type.includes('touch')) {
        e.preventDefault();
        const touch = e.touches[0] || e.changedTouches[0];
        const rect = canvas.getBoundingClientRect();
        x = touch.clientX - rect.left;
        y = touch.clientY - rect.top;
      } else {
        const rect = canvas.getBoundingClientRect();
        x = e.clientX - rect.left;
        y = e.clientY - rect.top;
      }
      
      return [x, y];
    }
    
    // 清空画布
    function clearCanvas() {
      if (isReplaying) return;
      
      if (confirm('确定要清空画布吗？此操作不可撤销。')) {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        
        // 记录清空画布的动作
        const timestamp = Date.now();
        const action = {
          type: 'clear',
          timestamp
        };
        
        drawingHistory.push(action);
        saveDrawingHistory();
        
        // 更新状态消息
        document.getElementById('status-message').textContent = '画布已清空';
        document.getElementById('last-updated').textContent = '最后更新: 刚刚';
      }
    }
    
    // 重绘画布内容
    function redrawCanvas() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // 重绘所有历史动作
      for (let i = 0; i < drawingHistory.length; i++) {
        const action = drawingHistory[i];
        
        if (action.type === 'clear') {
          ctx.clearRect(0, 0, canvas.width, canvas.height);
        } else if (action.type === 'start') {
          ctx.lineJoin = 'round';
          ctx.lineCap = 'round';
          ctx.lineWidth = action.size;
          
          if (action.tool === 'brush') {
            ctx.globalCompositeOperation = 'source-over';
            ctx.strokeStyle = action.color;
          } else if (action.tool === 'eraser') {
            ctx.globalCompositeOperation = 'destination-out';
          }
        } else if (action.type === 'draw') {
          ctx.beginPath();
          ctx.moveTo(action.lastX, action.lastY);
          ctx.lineTo(action.x, action.y);
          ctx.stroke();
        } else if (action.type === 'stop') {
          ctx.globalCompositeOperation = 'source-over';
        }
      }
    }
    
    // 保存绘画历史到本地存储
    function saveDrawingHistory() {
      localStorage.setItem('drawingHistory', JSON.stringify(drawingHistory));
    }
    
    // 从本地存储加载绘画历史
    function loadDrawingHistory() {
      const savedHistory = localStorage.getItem('drawingHistory');
      
      if (savedHistory) {
        drawingHistory = JSON.parse(savedHistory);
        redrawCanvas();
        
        // 更新状态消息
        if (drawingHistory.length > 0) {
          document.getElementById('status-message').textContent = '已加载历史绘画内容';
          
          // 计算最后更新时间
          const lastAction = drawingHistory[drawingHistory.length - 1];
          const lastTime = new Date(lastAction.timestamp);
          document.getElementById('last-updated').textContent = `最后更新: ${formatTime(lastTime)}`;
        }
      }
    }
    
    // 格式化时间
    function formatTime(date) {
      const now = new Date();
      const diff = now - date;
      
      // 小于1分钟
      if (diff < 60000) {
        return '刚刚';
      }
      
      // 小于1小时
      if (diff < 3600000) {
        const minutes = Math.floor(diff / 60000);
        return `${minutes}分钟前`;
      }
      
      // 小于24小时
      if (diff < 86400000) {
        const hours = Math.floor(diff / 3600000);
        return `${hours}小时前`;
      }
      
      // 其他情况显示具体时间
      const hours = date.getHours().toString().padStart(2, '0');
      const minutes = date.getMinutes().toString().padStart(2, '0');
      return `${hours}:${minutes}`;
    }
    
    // 回放绘画过程
    function startReplay() {
      if (drawingHistory.length === 0) {
        alert('没有绘画历史可以回放');
        return;
      }
      
      isReplaying = true;
      replayIndex = 0;
      
      // 显示回放控制
      document.getElementById('replay-controls').classList.remove('hidden');
      document.getElementById('replay-play').classList.add('hidden');
      document.getElementById('replay-pause').classList.remove('hidden');
      
      // 清空画布
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      
      // 更新状态消息
      document.getElementById('status-message').textContent = '正在回放绘画过程...';
      
      // 计算总时长
      const totalDuration = calculateTotalDuration();
      document.getElementById('total-time').textContent = formatDuration(totalDuration);
      
      // 开始回放
      replayInterval = setInterval(() => {
        if (replayIndex >= drawingHistory.length) {
          stopReplay();
          return;
        }
        
        const action = drawingHistory[replayIndex];
        replayAction(action);
        
        replayIndex++;
        
        // 更新时间显示
        const currentTime = calculateCurrentDuration(replayIndex);
        document.getElementById('replay-time').textContent = formatDuration(currentTime);
      }, 50 / replaySpeed);
    }
    
    // 回放单个动作
    function replayAction(action) {
      if (action.type === 'clear') {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
      } else if (action.type === 'start') {
        ctx.lineJoin = 'round';
        ctx.lineCap = 'round';
        ctx.lineWidth = action.size;
        
        if (action.tool === 'brush') {
          ctx.globalCompositeOperation = 'source-over';
          ctx.strokeStyle = action.color;
        } else if (action.tool === 'eraser') {
          ctx.globalCompositeOperation = 'destination-out';
        }
      } else if (action.type === 'draw') {
        ctx.beginPath();
        ctx.moveTo(action.lastX, action.lastY);
        ctx.lineTo(action.x, action.y);
        ctx.stroke();
      } else if (action.type === 'stop') {
        ctx.globalCompositeOperation = 'source-over';
      }
    }
    
    // 暂停回放
    function pauseReplay() {
      clearInterval(replayInterval);
      document.getElementById('replay-play').classList.remove('hidden');
      document.getElementById('replay-pause').classList.add('hidden');
      document.getElementById('status-message').textContent = '回放已暂停';
    }
    
    // 停止回放
    function stopReplay() {
      clearInterval(replayInterval);
      isReplaying = false;
      
      // 隐藏回放控制
      document.getElementById('replay-controls').classList.add('hidden');
      
      // 重绘画布
      redrawCanvas();
      
      // 更新状态消息
      document.getElementById('status-message').textContent = '回放已结束';
    }
    
    // 计算回放总时长
    function calculateTotalDuration() {
      if (drawingHistory.length === 0) return 0;
      
      const firstAction = drawingHistory[0];
      const lastAction = drawingHistory[drawingHistory.length - 1];
      
      return lastAction.timestamp - firstAction.timestamp;
    }
    
    // 计算当前回放时长
    function calculateCurrentDuration(index) {
      if (index <= 0 || drawingHistory.length === 0) return 0;
      
      const firstAction = drawingHistory[0];
      const currentAction = drawingHistory[index - 1];
      
      return currentAction.timestamp - firstAction.timestamp;
    }
    
    // 格式化时长
    function formatDuration(milliseconds) {
      const seconds = Math.floor(milliseconds / 1000);
      const minutes = Math.floor(seconds / 60);
      
      const remainingSeconds = seconds % 60;
      
      return `${minutes.toString().padStart(2, '0')}:${remainingSeconds.toString().padStart(2, '0')}`;
    }
    
    // 保存画布为图片
    function saveCanvas() {
      const link = document.createElement('a');
      link.download = `公共画板作品_${new Date().toISOString().slice(0, 10)}.png`;
      link.href = canvas.toDataURL();
      link.click();
      
      // 更新状态消息
      document.getElementById('status-message').textContent = '作品已保存';
    }
    
    // 获取随机颜色
    function getRandomColor() {
      const colors = [
        '#EF4444', '#F97316', '#EAB308', '#22C55E', 
        '#3B82F6', '#6366F1', '#A855F7', '#EC4899'
      ];
      
      return colors[Math.floor(Math.random() * colors.length)];
    }
    
    // 初始化事件监听
    function initEventListeners() {
      // 绘画事件
      canvas.addEventListener('mousedown', startDrawing);
      canvas.addEventListener('mousemove', draw);
      canvas.addEventListener('mouseup', stopDrawing);
      canvas.addEventListener('mouseout', stopDrawing);
      
      // 触摸事件
      canvas.addEventListener('touchstart', startDrawing);
      canvas.addEventListener('touchmove', draw);
      canvas.addEventListener('touchend', stopDrawing);
      
      // 工具选择
      document.querySelectorAll('[data-tool]').forEach(button => {
        button.addEventListener('click', () => {
          const tool = button.dataset.tool;
          
          if (tool === 'brush' || tool === 'eraser') {
            currentTool = tool;
            
            // 更新工具按钮状态
            document.querySelectorAll('.tool-btn').forEach(btn => {
              btn.classList.remove('active');
            });
            button.classList.add('active');
          } else if (tool === 'clear') {
            clearCanvas();
          } else if (tool === 'replay') {
            startReplay();
          } else if (tool === 'save') {
            saveCanvas();
          }
        });
      });
      
      // 画笔大小
      document.getElementById('brush-size').addEventListener('input', (e) => {
        currentSize = e.target.value;
        document.getElementById('size-value').textContent = currentSize;
        ctx.lineWidth = currentSize;
      });
      
      // 颜色选择
      document.querySelectorAll('[data-color]').forEach(button => {
        button.addEventListener('click', () => {
          currentColor = button.dataset.color;
          document.getElementById('custom-color').value = currentColor;
          ctx.strokeStyle = currentColor;
        });
      });
      
      // 自定义颜色
      document.getElementById('custom-color').addEventListener('input', (e) => {
        currentColor = e.target.value;
        ctx.strokeStyle = currentColor;
      });
      
      // 回放控制
      document.getElementById('replay-play').addEventListener('click', startReplay);
      document.getElementById('replay-pause').addEventListener('click', pauseReplay);
      document.getElementById('replay-stop').addEventListener('click', stopReplay);
      
      // 回放速度
      document.getElementById('replay-speed').addEventListener('input', (e) => {
        replaySpeed = e.target.value;
        document.getElementById('speed-value').textContent = `${replaySpeed}x`;
        
        // 如果正在回放，更新回放速度
        if (isReplaying) {
          clearInterval(replayInterval);
          
          replayInterval = setInterval(() => {
            if (replayIndex >= drawingHistory.length) {
              stopReplay();
              return;
            }
            
            const action = drawingHistory[replayIndex];
            replayAction(action);
            
            replayIndex++;
            
            // 更新时间显示
            const currentTime = calculateCurrentDuration(replayIndex);
            document.getElementById('replay-time').textContent = formatDuration(currentTime);
          }, 50 / replaySpeed);
        }
      });
      
      // 帮助模态框
      document.getElementById('help-btn').addEventListener('click', () => {
        document.getElementById('help-modal').classList.remove('hidden');
      });
      
      document.getElementById('close-help').addEventListener('click', () => {
        document.getElementById('help-modal').classList.add('hidden');
      });
      
      // 点击模态框背景关闭
      document.getElementById('help-modal').addEventListener('click', (e) => {
        if (e.target === document.getElementById('help-modal')) {
          document.getElementById('help-modal').classList.add('hidden');
        }
      });
      
      // 开始创作按钮
      document.getElementById('start-drawing').addEventListener('click', () => {
        document.getElementById('welcome-message').classList.add('hidden');
      });
    }
    
    // 初始化应用
    function initApp() {
      initCanvas();
      initEventListeners();
    }
    
    // 启动应用
    window.addEventListener('load', initApp);
  </script>
</body>
</html>